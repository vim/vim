*spell.txt*	For Vim version 7.0aa.  Last change: 2005 Jun 27


		  VIM REFERENCE MANUAL	  by Bram Moolenaar


Spell checking						*spell*

1. Quick start			|spell-quickstart|
2. Generating a spell file	|spell-mkspell|
3. Spell file format		|spell-file-format|

{Vi does not have any of these commands}

Spell checking is not available when the |+syntax| feature has been disabled
at compile time.

==============================================================================
1. Quick start						*spell-quickstart*

This command switches on spell checking: >

	:setlocal spell spelllang=en_us

This switches on the 'spell' option and specifies to check for US English.

The words that are not recognized are highlighted with one of these:
	SpellBad	word not recognized			|hl-SpellBad|
	SpellRare	rare word				|hl-SpellRare|
	SpellLocal	wrong spelling for selected region	|hl-SpellLocal|

Vim only checks words for spelling, there is no grammar check.

To search for the next misspelled word:

							*]s* *E756*
]s			Move to next misspelled word after the cursor.
			A count before the command can be used to repeat.
			This uses the @Spell and @NoSpell clusters from syntax
			highlighting, see |spell-syntax|.

							*[s*
[s			Like "]s" but search backwards, find the misspelled
			word before the cursor.  Doesn't recognize words
			split over two lines, thus may stop at words that are
			not highlighted as bad.

							*]S*
]S			Like "]s" but only stop at bad words, not at rare
			words or words for another region.

							*[S*
[S			Like "]S" but search backwards.


To add words to your own word list:				*E764*

							*zg*
zg			Add word under the cursor as a good word to
			'spellfile'.  In Visual mode the selected characters
			are added as a word (including white space!).

							*zw*
zw			Add word under the cursor as a wrong (bad) word to
			'spellfile'.  In Visual mode the selected characters
			are added as a word (including white space!).

							*:spe* *:spellgood*
:spe[llgood] {word}	Add [word} as a good word to 'spellfile'.

							*:spellw* *:spellwrong*
:spellw[rong] {word}	Add [word} as a wrong (bad) word to 'spellfile'.

After adding a word to 'spellfile' with the above commands its associated
".spl" file will automatically be updated.  If you edit 'spellfile' manually
you need to use the |:mkspell| command.  This sequence of commands mostly
works well: >
	:exe 'e ' . &spellfile
<	(make changes to the spell file) >
	:mkspell! %

More details about the 'spellfile' format below |spell-wordlist-format|.


Finding suggestions for bad words:

							*z?*
z?			For the word under/after the cursor suggest correctly
			spelled words.  This also works to find alternative
			for words that are not highlighted as bad words.
			The results are sorted on similarity to the word
			under/after the cursor.
			This may take a long time.  Hit CTRL-C when you are
			bored.
			You can enter the number of your choice or press
			<Enter> if you don't want to replace.
			If 'verbose' is non-zero a score will be displayed to
			indicate the likeliness to the badly spelled word (the
			higher the score the more different).
			When a word was replaced the redo command "." will
			repeat the word replacement.  This works like "ciw",
			the good word and <Esc>.

The 'spellsuggest' option influences how the list of suggestions is generated
and sorted.  See |'spellsuggest'|.


PERFORMANCE

Note that Vim does on-the-fly spell checking.  To make this work fast the
word list is loaded in memory.  Thus this uses a lot of memory (1 Mbyte or
more).  There might also be a noticeable delay when the word list is loaded,
which happens when 'spell' is set and when 'spelllang' is set while 'spell'
was already set.  Each word list is only loaded once, they are not deleted
when 'spelllang' is made empty or 'spell' is reset.  When 'encoding' is set
all the word lists are reloaded, thus you may notice a delay then too.


REGIONS

A word may be spelled differently in various regions.  For example, English
comes in (at least) these variants:

	en		all regions
	en_au		Australia
	en_ca		Canada
	en_gb		Great Britain
	en_nz		New Zealand
	en_us		USA

Words that are not used in one region but are used in another region are
highlighted with SpellLocal |hl-SpellLocal|.

Always use lowercase letters for the language and region names.

When adding a word with |zg| or another command it's always added for all
regions.  You can change that by manually editing the 'spellfile'.  See
|spell-wordlist-format|.


SPELL FILES						*spell-load*

Vim searches for spell files in the "spell" subdirectory of the directories in
'runtimepath'.  The name is: LL.EEE.spl, where:
	LL	the language name
	EEE	the value of 'encoding'

The value for "LL" comes from 'spelllang', but excludes the region name.
Examples:
	'spelllang'	LL ~
	en_us		en
	en-rare		en-rare
	medical_ca	medical

Only the first file is loaded, the one that is first in 'runtimepath'.  If
this succeeds then additionally files with the name LL.EEE.add.spl are loaded.
All the ones that are found are used.

Additionally, the file related to 'spellfile' is loaded.  This is the file
that |zg| and |zw| add good and wrong words to.

Exceptions:
- Vim uses "latin1" when 'encoding' is "iso-8859-15".  The euro sign doesn't
  matter for spelling.
- When no spell file for 'encoding' is found "ascii" is tried.  This only
  works for languages where nearly all words are ASCII, such as English.  It
  helps when 'encoding' is not "latin1", such as iso-8859-2, and English text
  is being edited.  For the ".add" files the same name as the found main
  spell file is used.

For example, with these values:
	'runtimepath' is "~/.vim,/usr/share/vim70,~/.vim/after"
	'encoding'    is "iso-8859-2"
	'spelllang'   is "pl"

Vim will look for:
1. ~/.vim/spell/pl.iso-8859-2.spl
2. /usr/share/vim70/spell/pl.iso-8859-2.spl
3. ~/.vim/spell/pl.iso-8859-2.add.spl
4. /usr/share/vim70/spell/pl.iso-8859-2.add.spl
5. ~/.vim/after/spell/pl.iso-8859-2.add.spl

This assumes 1. is not found and 2. is found.

If 'encoding' is "latin1" Vim will look for:
1. ~/.vim/spell/pl.latin1.spl
2. /usr/share/vim70/spell/pl.latin1.spl
3. ~/.vim/after/spell/pl.latin1.spl
4. ~/.vim/spell/pl.ascii.spl
5. /usr/share/vim70/spell/pl.ascii.spl
6. ~/.vim/after/spell/pl.ascii.spl

This assumes none of them are found (Polish doesn't make sense when leaving
out the non-ASCII characters).

Spelling for EBCDIC is currently not supported.

A spell file might not be available in the current 'encoding'.  See
|spell-mkspell| about how to create a spell file.  Converting a spell file
with "iconv" will NOT work!

							*E758* *E759*
When loading a spell file Vim checks that it is properly formatted.  If you
get an error the file may be truncated, modified or intended for another Vim
version.


WORDS

Vim uses a fixed method to recognize a word.  This is independent of
'iskeyword', so that it also works in help files and for languages that
include characters like '-' in 'iskeyword'.  The word characters do depend on
'encoding'.

The table with word characters is stored in the main .spl file.  Therefore it
matters what the current locale is when generating it!  A .add.spl file does
not contain a word table though.

A word that starts with a digit is always ignored.  That includes hex numbers
in the form 0xff and 0XFF.


WORD COMBINATIONS

It is possible to spell-check words that include a space.  This is used to
recognize words that are invalid when used by themselves, e.g. for "et al.".
It can also be used to recognize "the the" and highlight it.

The number of spaces is irrelevant.  In most cases a line break may also
appear.  However, this makes it difficult to find out where to start checking
for spelling mistakes.  When you make a change to one line and only that line
is redrawn Vim won't look in the previous line, thus when "et" is at the end
of the previous line "al." will be flagged as an error.  And when you type
"the<CR>the" the highlighting doesn't appear until the first line is redrawn.
Use |CTRL-L| to redraw right away.  "[s" will also stop at a word combination
with a line break.

When encountering a line break Vim skips characters such as '*', '>' and '"',
so that comments in C, shell and Vim code can be spell checked.


SYNTAX HIGHLIGHTING					*spell-syntax*

Files that use syntax highlighting can specify where spell checking should be
done:

1.  everywhere			   default
2.  in specific items		   use "contains=@Spell"
3.  everywhere but specific items  use "contains=@NoSpell"

For the second method adding the @NoSpell cluster will disable spell checking
again.  This can be used, for example, to add @Spell to the comments of a
program, and add @NoSpell for items that shouldn't be checked.


VIM SCRIPTS

If you want to write a Vim script that does something with spelling, you may
find these functions useful:

    spellbadword()	find badly spelled word at the cursor
    spellsuggest()	get list of spelling suggestions

==============================================================================
2. Generating a spell file				*spell-mkspell*

Vim uses a binary file format for spelling.  This greatly speeds up loading
the word list and keeps it small.
						    *.aff* *.dic* *Myspell*
You can create a Vim spell file from the .aff and .dic files that Myspell
uses.  Myspell is used by OpenOffice.org and Mozilla.  You should be able to
find them here:
	http://lingucomponent.openoffice.org/spell_dic.html
You can also use a plain word list.  The results are the same, the choice
depends on what you find.

Make sure your current locale is set properly, otherwise Vim doesn't know what
characters are upper/lower case letters.  If the locale isn't available (e.g.,
when using an MS-Windows codepage on Unix) add tables to the .aff file
|spell-affix-chars|.  If the .aff file doesn't define a table then the word
table of the currently active spelling is used.  If spelling is not active
then Vim will try to guess.

							*:mksp* *:mkspell*
:mksp[ell][!] [-ascii] {outname} {inname} ...
			Generate a Vim spell file word lists.  Example: >
		:mkspell nl nl_NL.words
<								*E751*
			When {outname} ends in ".spl" it is used as the output
			file name.  Otherwise it should be a language name,
			such as "en", without the region name.  The file
			written will be "{outname}.{encoding}.spl", where
			{encoding} is the value of the 'encoding' option.

			When the output file already exists [!] must be added
			to overwrite it.

			When the [-ascii] argument is present, words with
			non-ascii characters are skipped.  The resulting file
			ends in "ascii.spl".

			The input can be the Myspell format files {inname}.aff
			and {inname}.dic.  If {inname}.aff does not exist then
			{inname} is used as the file name of a plain word
			list.

			Multiple {inname} arguments can be given to combine
			regions into one Vim spell file.  Example: >
		:mkspell ~/.vim/spell/en /tmp/en_US /tmp/en_CA /tmp/en_AU
<			This combines the English word lists for US, CA and AU
			into one en.spl file.
			Up to eight regions can be combined. *E754* *755*
			The REP and SAL items of the first .aff file where
			they appear are used. |spell-affix-REP|
			|spell-affix-SAL|

			This command uses a lot of memory, required to find
			the optimal word tree (Polish requires a few hundred
			Mbyte).  The final result will be much smaller.

			When the spell file was written all currently used
			spell files will be reloaded.

:mksp[ell] [-ascii] {name}.{enc}.add
			Like ":mkspell" above, using {name}.{enc}.add as the
			input file and producing an output file that has
			".spl" appended.

:mksp[ell] [-ascii] {name}
			Like ":mkspell" above, using {name} as the input file
			and producing an output file that has ".{enc}.spl"
			appended.

Since you might want to change a Myspell word list for use with Vim the
following procedure is recommended:

1. Obtain the xx_YY.aff and xx_YY.dic files from Myspell.
2. Make a copy of these files to xx_YY.orig.aff and xx_YY.orig.dic.
3. Change the xx_YY.aff and xx_YY.dic files to remove bad words, add missing
   words, define word characters with FOL/LOW/UPP, etc.  The distributed
   "src/spell/*.diff" files can be used.
4. Set 'encoding' to the desired encoding and use |:mkspell| to generate the
   Vim spell file.
5. Try out the spell file with ":set spell spelllang=xx_YY".

When the Myspell files are updated you can merge the differences:
1. Obtain the new Myspell files as xx_YY.new.aff and xx_UU.new.dic.
2. Use Vimdiff to see what changed: >
	vimdiff xx_YY.orig.dic xx_YY.new.dic
3. Take over the changes you like in xx_YY.dic.
   You may also need to change xx_YY.aff.
4. Rename xx_YY.new.dic to xx_YY.orig.dic and xx_YY.new.aff to xx_YY.new.aff.


SPELL FILE DUMP

If for some reason you want to check what words are supported by the currently
used spelling files, use this command:

							*:spelldump* *:spelld*
:spelld[ump]		Open a new window and fill it with all currently valid
			words.
			Note: For some languages the result may be huge and
			Vim may run out of memory.

The format of the word list is used |spell-wordlist-format|.  You should be
able to read it with ":mkspell" to generate one .spl file that includes all
the words.

Only words for the current region are included.  No "/regions" line is
generated.

Comment lines are used to indicate which .spl file the words came from.

==============================================================================
3. Spell file format					*spell-file-format*

This is the format of the files that are used by the person who creates and
maintains a word list.

Note that we avoid the word "dictionary" here.  That is because the goal of
spell checking differs from writing a dictionary (as in the book).  For
spelling we need a list of words that are OK, thus need not to be highlighted.
Names will not appear in a dictionary, but do appear in a word list.  And
some old words are rarely used and are common misspellings.  These do appear
in a dictionary but not in a word list.

There are two formats: one with affix compression and one without.  The files
with affix compression are used by Myspell (Mozilla and OpenOffice.org).  This
requires two files, one with .aff and one with .dic extension.  The second
format is a list of words.


FORMAT OF WORD LIST				*spell-wordlist-format*

The words must appear one per line.  That is all that is required.
Additionally the following items are recognized:
- Empty and blank lines are ignored.
- Lines starting with a # are ignored (comment lines).
- A line starting with "/encoding=", before any word, specifies the encoding
  of the file.  After the second '=' comes an encoding name.  This tells Vim
  to setup conversion from the specified encoding to 'encoding'.
- A line starting with "/regions=" specifies the region names that are
  supported.  Each region name must be two ASCII letters.  The first one is
  region 1.  Thus "/regions=usca" has region 1 "us" and region 2 "ca".
  In an addition word list the list should be equal to the main word list!
- A line starting with "/?" specifies a word that should be marked as rare.
- A line starting with "/!" specifies a word that should be marked as bad.
- A line starting with "/=" specifies a word where case must match exactly.
  A "?" or "!" may be following: "/=?" and "/=!".
- Digits after "/" indicate the regions in which the word is valid.  If no
  regions are specified the word is valid in all regions.
- Other lines starting with '/' are reserved for future use.  The ones that
  are not recognized are ignored (but you do get a warning message).

Example:

	# This is an example word list		comment
	/encoding=latin1			encoding of the file
	/regions=uscagb				regions "us", "ca" and "gb"
	example					word for all regions
	/1blah					word for region 1 "us"
	/!vim					bad word
	/?3Campbell				rare word in region 3 "gb"
	/='s mornings				keep-case word


FORMAT WITH AFFIX COMPRESSION

There are two files: the basic word list and an affix file.  The affixes are
used to modify the basic words to get the full word list.  This significantly
reduces the number of words, especially for a language like Polish.  This is
called affix compression.

The format for the affix and word list files is mostly identical to what
Myspell uses (the spell checker of Mozilla and OpenOffice.org).  A description
can be found here:
	http://lingucomponent.openoffice.org/affix.readme ~
Note that affixes are case sensitive, this isn't obvious from the description.

Vim supports a few extras.  Hopefully Myspell will support these too some day.
See |spell-affix-vim|.

The basic word list and the affix file are combined and turned into a binary
spell file.  All the preprocessing has been done, thus this file loads fast.
The binary spell file format is described in the source code (src/spell.c).
But only developers need to know about it.

The preprocessing also allows us to take the Myspell language files and modify
them before the Vim word list is made.  The tools for this can be found in the
"src/spell" directory.


WORD LIST FORMAT				*spell-dic-format*

A very short example, with line numbers:

	1	1234
	2	aan
	3	Als
	4	Etten-Leur
	5	et al.
	6	's-Gravenhage
	7	's-Gravenhaags
	8	bedel/P
	9	kado/1
	10	cadeau/2

The first line contains the number of words.  Vim ignores it, but you do get
an error message if it's not there.  *E760*

What follows is one word per line.  There should be no white space before or
after the word.

When the word only has lower-case letters it will also match with the word
starting with an upper-case letter.

When the word includes an upper-case letter, this means the upper-case letter
is required at this position.  The same word with a lower-case letter at this
position will not match. When some of the other letters are upper-case it will
not match either.

The same word with all upper-case characters will always be OK.

	word list	matches			does not match ~
	als		als Als ALS		ALs AlS aLs aLS
	Als		Als  ALS		als ALs AlS aLs aLS
	ALS		ALS			als Als ALs AlS aLs aLS
	AlS		AlS ALS			als Als ALs aLs aLS

The KEP affix ID can be used to specifically match a word with identical case
only, see below |spell-affix-KEP|.

Note in line 5 to 7 that non-word characters are used.  You can include
any character in a word.  When checking the text a word still only matches
when it appears with a non-word character before and after it.  For Myspell a
word starting with a non-word character probably won't work.

After the word there is an optional slash and flags.  Most of these flags are
letters that indicate the affixes that can be used with this word.

							*spell-affix-vim*
A flag that Vim adds and is not in Myspell is the flag defined with KEP in the
affix file.  This has the meaning that case matters.  This can be used if the
word does not have the first letter in upper case at the start of a sentence.
Example (assuming that = was used for KEP):

	word list	matches			does not match ~
	's morgens/=	's morgens		'S morgens 's Morgens
	's Morgens	's Morgens		'S morgens 's morgens

							*spell-affix-mbyte*
The basic word list is normally in an 8-bit encoding, which is mentioned in
the affix file.  The affix file must always be in the same encoding as the
word list.  This is compatible with Myspell.  For Vim the encoding may also be
something else, any encoding that "iconv" supports.  The "SET" line must
specify the name of the encoding.  When using a multi-byte encoding it's
possible to use more different affixes.


CHARACTER TABLES
							*spell-affix-chars*
When using an 8-bit encoding the affix file should define what characters are
word characters (as specified with ENC).  This is because the system where
":mkspell" is used may not support a locale with this encoding and isalpha()
won't work.  For example when using "cp1250" on Unix.

					*E761* *E762* *spell-affix-FOL*
					*spell-affix-LOW* *spell-affix-UPP*
Three lines in the affix file are needed.  Simplistic example:

	FOL  áëñ ~
	LOW  áëñ ~
	UPP  ÁËÑ ~

All three lines must have exactly the same number of characters.

The "FOL" line specifies the case-folded characters.  These are used to
compare words while ignoring case.  For most encodings this is identical to
the lower case line.

The "LOW" line specifies the characters in lower-case.  Mostly it's equal to
the "FOL" line.

The "UPP" line specifies the characters with upper-case.  That is, a character
is upper-case where it's different from the character at the same position in
"FOL".

ASCII characters should be omitted, Vim always handles these in the same way.
When the encoding is UTF-8 no word characters need to be specified.

							*E763*
Vim allows you to use spell checking for several languages in the same file.
You can list them in the 'spelllang' option.  As a consequence all spell files
for the same encoding must use the same word characters, otherwise they can't
be combined without errors.  If you get a warning that the word tables differ
you may need to generate the .spl file again with |:mkspell|.  Check the FOL,
LOW and UPP lines in the used .aff file.

The XX.ascii.spl spell file generated with the "-ascii" argument will not
contain the table with characters, so that it can be combine with spell files
for any encoding.  The .add.spl files also do not contain the table.


MID-WORD CHARACTERS
							*spell-midword*
Some characters are only to be considered word characters if they are used in
between two ordinary word characters.  An example is the single quote: It is
often used to put text in quotes, thus it can't be recognized as a word
character, but when it appears in between word characters it must be part of
the word.  This is needed to detect a spelling error such as they'are.  That
should be they're, but since "they" and "are" are words themselves that would
go unnoticed.

These characters are defined with MIDWORD in the .aff file:

	MIDWORD	'- ~


AFFIXES
					    *spell-affix-PFX* *spell-affix-SFX*
The usual PFX (prefix) and SFX (suffix) lines are supported (see the Myspell
documentation or the Aspell manual:
http://aspell.net/man-html/Affix-Compression.html).

Note that Myspell ignores any extra text after the relevant info.  Vim
requires this text to start with a "#" so that mistakes don't go unnoticed.
Example:

	SFX F 0 in   [^i]n      # Spion > Spionin  ~
	SFX F 0 nen  in         # Bauerin > Bauerinnen ~

An extra item for Vim is the "rare" flag.  It must come after the other
fields, before a comment.  When used then all words that use the affix will be
marked as rare words.  Example:

	PFX F 0 nene  .   rare ~
	SFX F 0 oin   n   rare   # hardly ever used ~

However, if the word also appears as a good word in another way it won't be
marked as rare.

						    *spell-affix-PFXPOSTPONE*
When an affix file has very many prefixes that apply to many words it's not
possible to build the whole word list in memory.  This applies to Hebrew (a
list with all words is over a Gbyte).  In that case applying prefixes must be
postponed.  This makes spell checking slower.  It is indicated by this keyword
in the .aff file:

	PFXPOSTPONE ~

Only prefixes without a chop string can be postponed, prefixes with a chop
string will still be included in the word list.


KEEP-CASE WORDS
							*spell-affix-KEP*
In the affix file a KEP line can be used to define the affix name used for
keep-case words.  Example:

	KEP = ~

See above for an example |spell-affix-vim|.


RARE WORDS
							*spell-affix-RAR*
In the affix file a RAR line can be used to define the affix name used for
rare words.  Example:

	RAR ? ~

Rare words are highlighted differently from bad words.  This is to be used for
words that are correct for the language, but are hardly ever used and could be
a typing mistake anyway.  When the same word is found as good it won't be
highlighted as rare.


BAD WORDS
							*spell-affix-BAD*
In the affix file a BAD line can be used to define the affix name used for
bad words.  Example:

	BAD ! ~

This can be used to exclude words that would otherwise be good.  For example
"the the" in the .dic file:

	the the/! ~

Once a word has been marked as bad it won't be undone by encountering the same
word as good.


REPLACEMENTS						*spell-affix-REP*

In the affix file REP items can be used to define common mistakes.  This is
used to make spelling suggestions.  The items define the "from" text and the
"to" replacement.  Example:

	REP 4 ~
	REP f ph ~
	REP ph f ~
	REP k ch ~
	REP ch k ~

The first line specifies the number of REP lines following.  Vim ignores it.


SIMILAR CHARACTERS					*spell-affix-MAP*

In the affix file MAP items can be used to define letters that very much
alike.  This is mostly used for a letter with different accents.  This is used
to prefer suggestions with these letters substituted.  Example:

	MAP 2 ~
	MAP eéëêè ~
	MAP uüùúû ~

The first line specifies the number of MAP lines following.  Vim ignores it.

A letter must only appear in one of the MAP items.  It's a bit more efficient
if the first letter is ASCII or at least one without accents.


SOUNDS-A-LIKE						*spell-affix-SAL*

In the affix file SAL items can be used to define the sounds-a-like mechanism
to be used.  The main items define the "from" text and the "to" replacement.
Example:

	SAL CIA                  X ~
	SAL CH                   X ~
	SAL C                    K ~
	SAL K                    K ~

TODO: explain how it works.

There are a few special items:

	SAL followup		true ~
	SAL collapse_result	true ~
	SAL remove_accents	true ~

"1" has the same meaning as "true".  Any other value means "false".

 vim:tw=78:sw=4:ts=8:ft=help:norl:
